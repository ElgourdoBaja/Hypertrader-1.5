{"ast":null,"code":"import _objectSpread from\"/app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import axios from'axios';import{TrendingUp,TrendingDown,DollarSign,Clock,AlertCircle,Target,Zap}from'lucide-react';import LoadingSpinner from'./LoadingSpinner';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Trading=()=>{var _marketData$change_,_orderBook$asks,_orderBook$bids;const[orderForm,setOrderForm]=useState({coin:'BTC',side:'long',// Changed from 'buy' to 'long' for perps\norderType:'limit',size:'',price:'',leverage:1,reduceOnly:false,postOnly:false});const[marketData,setMarketData]=useState({});const[orderBook,setOrderBook]=useState(null);const[openOrders,setOpenOrders]=useState([]);const[loading,setLoading]=useState(false);const[submitLoading,setSubmitLoading]=useState(false);const[message,setMessage]=useState(null);const[availableCoins,setAvailableCoins]=useState([]);// Top 20 most popular perp pairs for quick access\nconst popularPairs=['BTC','ETH','SOL','AVAX','MATIC','DOGE','LINK','UNI','AAVE','ARB','OP','LTC','XRP','BCH','APT','SUI','SEI','INJ','TIA','NEAR'];useEffect(()=>{fetchAvailableCoins();fetchTradingData();const interval=setInterval(fetchTradingData,10000);// Update every 10 seconds\nreturn()=>clearInterval(interval);},[orderForm.coin]);const fetchAvailableCoins=async()=>{try{const response=await axios.get('/api/coins');if(response.data.success){setAvailableCoins(response.data.data);}}catch(error){console.error('Error fetching available coins:',error);}};const fetchTradingData=async()=>{try{setLoading(true);// Fetch market data\nconst marketResponse=await axios.get(\"/api/market/\".concat(orderForm.coin));if(marketResponse.data.success){setMarketData(marketResponse.data.data);// Auto-fill price for market orders\nif(orderForm.orderType==='market'){const price=orderForm.side==='long'?marketResponse.data.data.ask:marketResponse.data.data.bid;setOrderForm(prev=>_objectSpread(_objectSpread({},prev),{},{price:(price===null||price===void 0?void 0:price.toFixed(2))||''}));}}// Fetch order book\nconst orderBookResponse=await axios.get(\"/api/orderbook/\".concat(orderForm.coin));if(orderBookResponse.data.success){setOrderBook(orderBookResponse.data.data);}// Fetch open orders\nconst ordersResponse=await axios.get('/api/orders/open');if(ordersResponse.data.success){setOpenOrders(ordersResponse.data.data);}}catch(error){console.error('Error fetching trading data:',error);setMessage({type:'error',text:'Failed to fetch trading data'});}finally{setLoading(false);}};const handleInputChange=(field,value)=>{setOrderForm(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:value}));// Auto-fill price for market orders\nif(field==='orderType'&&value==='market'){const price=orderForm.side==='long'?marketData.ask:marketData.bid;setOrderForm(prev=>_objectSpread(_objectSpread({},prev),{},{price:(price===null||price===void 0?void 0:price.toFixed(2))||''}));}// Auto-fill price when switching sides\nif(field==='side'){const price=value==='long'?marketData.ask:marketData.bid;if(orderForm.orderType==='market'){setOrderForm(prev=>_objectSpread(_objectSpread({},prev),{},{price:(price===null||price===void 0?void 0:price.toFixed(2))||''}));}}};const handleSubmitOrder=async e=>{e.preventDefault();if(!orderForm.size||!orderForm.price&&orderForm.orderType==='limit'){setMessage({type:'error',text:'Please fill in all required fields'});return;}if(orderForm.leverage<1||orderForm.leverage>getMaxLeverage()){setMessage({type:'error',text:\"Leverage must be between 1x and \".concat(getMaxLeverage(),\"x\")});return;}try{setSubmitLoading(true);setMessage(null);const orderRequest={coin:orderForm.coin,is_buy:orderForm.side==='long',sz:parseFloat(orderForm.size),limit_px:orderForm.orderType==='limit'?parseFloat(orderForm.price):null,order_type:orderForm.orderType,reduce_only:orderForm.reduceOnly,leverage:orderForm.leverage};const response=await axios.post('/api/orders',orderRequest);if(response.data.success){setMessage({type:'success',text:\"\".concat(orderForm.side.toUpperCase(),\" order placed successfully! Size: \").concat(orderForm.size,\" \").concat(orderForm.coin,\" @ \").concat(orderForm.leverage,\"x leverage\")});setOrderForm(prev=>_objectSpread(_objectSpread({},prev),{},{size:'',price:''}));fetchTradingData();// Refresh data\n}else{setMessage({type:'error',text:response.data.message||'Failed to place order'});}}catch(error){var _error$response,_error$response$data;console.error('Error placing order:',error);setMessage({type:'error',text:((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||'Failed to place order'});}finally{setSubmitLoading(false);}};const handleCancelOrder=async(coin,oid)=>{try{const response=await axios.delete(\"/api/orders/\".concat(coin,\"/\").concat(oid));if(response.data.success){setMessage({type:'success',text:'Order cancelled successfully!'});fetchTradingData();// Refresh data\n}else{setMessage({type:'error',text:'Failed to cancel order'});}}catch(error){console.error('Error cancelling order:',error);setMessage({type:'error',text:'Failed to cancel order'});}};const getMaxLeverage=()=>{const coin=availableCoins.find(c=>c.symbol===orderForm.coin);return(coin===null||coin===void 0?void 0:coin.maxLeverage)||1;};const calculateNotionalValue=()=>{const size=parseFloat(orderForm.size)||0;const price=parseFloat(orderForm.price)||marketData.price||0;return size*price;};const calculateMarginRequired=()=>{const notional=calculateNotionalValue();return notional/orderForm.leverage;};const formatPrice=price=>{return\"$\".concat((price===null||price===void 0?void 0:price.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2}))||'0.00');};const handleQuickFill=percentage=>{// In a real implementation, this would use actual account balance\nconst mockBalance=10000;// $10,000 mock balance\nconst price=parseFloat(orderForm.price)||marketData.price||0;const availableForPosition=mockBalance*percentage/100*orderForm.leverage;const size=availableForPosition/price;setOrderForm(prev=>_objectSpread(_objectSpread({},prev),{},{size:size.toFixed(6)}));};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-white\",children:\"Perpetual Futures Trading\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Mark Price\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-bold text-white\",children:formatPrice(marketData.price)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-3 py-1 rounded \".concat(marketData.change_24h>=0?'bg-green-900 text-green-300':'bg-red-900 text-red-300'),children:[marketData.change_24h>=0?'+':'',(_marketData$change_=marketData.change_24h)===null||_marketData$change_===void 0?void 0:_marketData$change_.toFixed(2),\"%\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-800 p-4 rounded-lg border border-gray-700\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-gray-400 mb-2\",children:\"Popular Pairs\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:popularPairs.map(pair=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleInputChange('coin',pair),className:\"px-3 py-1 rounded text-sm font-medium transition-colors \".concat(orderForm.coin===pair?'bg-blue-600 text-white':'bg-gray-700 text-gray-300 hover:bg-gray-600'),children:pair},pair))})]}),message&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-lg flex items-center space-x-2 \".concat(message.type==='success'?'bg-green-900 text-green-300 border border-green-700':'bg-red-900 text-red-300 border border-red-700'),children:[/*#__PURE__*/_jsx(AlertCircle,{size:20}),/*#__PURE__*/_jsx(\"span\",{children:message.text})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-800 p-6 rounded-lg border border-gray-700\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-bold text-white mb-4 flex items-center\",children:[/*#__PURE__*/_jsx(Target,{className:\"w-5 h-5 mr-2\"}),\"Place Order\"]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitOrder,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-400 mb-2\",children:\"Perpetual Contract\"}),/*#__PURE__*/_jsx(\"select\",{value:orderForm.coin,onChange:e=>handleInputChange('coin',e.target.value),className:\"w-full bg-gray-700 text-white px-3 py-2 rounded border border-gray-600 focus:outline-none focus:border-blue-400\",children:availableCoins.map(coin=>/*#__PURE__*/_jsxs(\"option\",{value:coin.symbol,children:[coin.symbol,\"-PERP (Max: \",coin.maxLeverage,\"x)\"]},coin.symbol))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-400 mb-2\",children:\"Position Direction\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-2\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>handleInputChange('side','long'),className:\"py-3 px-4 rounded font-medium transition-colors flex items-center justify-center \".concat(orderForm.side==='long'?'bg-green-600 text-white':'bg-gray-700 text-gray-300 hover:bg-gray-600'),children:[/*#__PURE__*/_jsx(TrendingUp,{size:16,className:\"mr-2\"}),\"LONG\"]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>handleInputChange('side','short'),className:\"py-3 px-4 rounded font-medium transition-colors flex items-center justify-center \".concat(orderForm.side==='short'?'bg-red-600 text-white':'bg-gray-700 text-gray-300 hover:bg-gray-600'),children:[/*#__PURE__*/_jsx(TrendingDown,{size:16,className:\"mr-2\"}),\"SHORT\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-400 mb-2\",children:[\"Leverage: \",orderForm.leverage,\"x (Max: \",getMaxLeverage(),\"x)\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"1\",max:getMaxLeverage(),step:\"1\",value:orderForm.leverage,onChange:e=>handleInputChange('leverage',parseInt(e.target.value)),className:\"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs text-gray-500 mt-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"1x\"}),/*#__PURE__*/_jsxs(\"span\",{children:[getMaxLeverage(),\"x\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-400 mb-2\",children:\"Order Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:orderForm.orderType,onChange:e=>handleInputChange('orderType',e.target.value),className:\"w-full bg-gray-700 text-white px-3 py-2 rounded border border-gray-600 focus:outline-none focus:border-blue-400\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"limit\",children:\"Limit Order\"}),/*#__PURE__*/_jsx(\"option\",{value:\"market\",children:\"Market Order\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-400 mb-2\",children:[\"Size (\",orderForm.coin,\")\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.000001\",value:orderForm.size,onChange:e=>handleInputChange('size',e.target.value),placeholder:\"0.000000\",className:\"w-full bg-gray-700 text-white px-3 py-2 rounded border border-gray-600 focus:outline-none focus:border-blue-400\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-1 mt-2\",children:[25,50,75,100].map(percentage=>/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>handleQuickFill(percentage),className:\"flex-1 py-1 px-2 text-xs bg-gray-600 hover:bg-gray-500 rounded transition-colors\",children:[percentage,\"%\"]},percentage))})]}),orderForm.orderType==='limit'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-400 mb-2\",children:\"Price (USD)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",value:orderForm.price,onChange:e=>handleInputChange('price',e.target.value),placeholder:\"0.00\",className:\"w-full bg-gray-700 text-white px-3 py-2 rounded border border-gray-600 focus:outline-none focus:border-blue-400\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"reduceOnly\",checked:orderForm.reduceOnly,onChange:e=>handleInputChange('reduceOnly',e.target.checked),className:\"w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"reduceOnly\",className:\"text-sm text-gray-400\",children:\"Reduce Only\"})]}),orderForm.orderType==='limit'&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"postOnly\",checked:orderForm.postOnly,onChange:e=>handleInputChange('postOnly',e.target.checked),className:\"w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"postOnly\",className:\"text-sm text-gray-400\",children:\"Post Only\"})]})]}),orderForm.size&&orderForm.price&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 bg-gray-700 rounded space-y-1 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400\",children:\"Notional Value:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white\",children:formatPrice(calculateNotionalValue())})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400\",children:\"Margin Required:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white\",children:formatPrice(calculateMarginRequired())})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400\",children:\"Leverage:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-white\",children:[orderForm.leverage,\"x\"]})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:submitLoading,className:\"w-full py-3 px-4 rounded font-medium transition-colors flex items-center justify-center \".concat(orderForm.side==='long'?'bg-green-600 hover:bg-green-700 text-white':'bg-red-600 hover:bg-red-700 text-white',\" disabled:opacity-50 disabled:cursor-not-allowed\"),children:submitLoading?/*#__PURE__*/_jsx(LoadingSpinner,{size:\"small\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Zap,{size:16,className:\"mr-2\"}),orderForm.side.toUpperCase(),\" \",orderForm.coin,\"-PERP\"]})})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-800 p-6 rounded-lg border border-gray-700\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-white mb-4\",children:\"Order Book\"}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center py-8\",children:/*#__PURE__*/_jsx(LoadingSpinner,{})}):orderBook?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-red-400 mb-2\",children:\"Asks (Resistance)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-1\",children:(_orderBook$asks=orderBook.asks)===null||_orderBook$asks===void 0?void 0:_orderBook$asks.slice(0,10).map((level,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm hover:bg-red-900/20 p-1 rounded cursor-pointer\",onClick:()=>orderForm.orderType==='limit'&&handleInputChange('price',level.price.toString()),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-red-400 font-mono\",children:formatPrice(level.price)}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400\",children:level.size})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-2 border-t border-b border-gray-700\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg font-bold text-white\",children:formatPrice(marketData.price)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400\",children:\"Mark Price\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-green-400 mb-2\",children:\"Bids (Support)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-1\",children:(_orderBook$bids=orderBook.bids)===null||_orderBook$bids===void 0?void 0:_orderBook$bids.slice(0,10).map((level,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm hover:bg-green-900/20 p-1 rounded cursor-pointer\",onClick:()=>orderForm.orderType==='limit'&&handleInputChange('price',level.price.toString()),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-400 font-mono\",children:formatPrice(level.price)}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400\",children:level.size})]},index))})]})]}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400 text-center py-8\",children:\"No order book data available\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-800 p-6 rounded-lg border border-gray-700\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-white mb-4\",children:\"Open Orders\"}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center py-8\",children:/*#__PURE__*/_jsx(LoadingSpinner,{})}):openOrders.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:openOrders.map((order,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 bg-gray-700 rounded border border-gray-600\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold text-white\",children:[order.coin,\"-PERP\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded text-xs font-medium \".concat(order.side==='buy'?'bg-green-900 text-green-300':'bg-red-900 text-red-300'),children:order.side==='buy'?'LONG':'SHORT'})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleCancelOrder(order.coin,order.oid),className:\"text-red-400 hover:text-red-300 text-sm\",children:\"Cancel\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-400\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Size: \",order.size]}),order.price&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Price: \",formatPrice(order.price)]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Type: \",order.order_type]})]})]},index))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400 text-center py-8\",children:\"No open orders\"})]})})]})]});};export default Trading;","map":{"version":3,"names":["React","useState","useEffect","axios","TrendingUp","TrendingDown","DollarSign","Clock","AlertCircle","Target","Zap","LoadingSpinner","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Trading","_marketData$change_","_orderBook$asks","_orderBook$bids","orderForm","setOrderForm","coin","side","orderType","size","price","leverage","reduceOnly","postOnly","marketData","setMarketData","orderBook","setOrderBook","openOrders","setOpenOrders","loading","setLoading","submitLoading","setSubmitLoading","message","setMessage","availableCoins","setAvailableCoins","popularPairs","fetchAvailableCoins","fetchTradingData","interval","setInterval","clearInterval","response","get","data","success","error","console","marketResponse","concat","ask","bid","prev","_objectSpread","toFixed","orderBookResponse","ordersResponse","type","text","handleInputChange","field","value","handleSubmitOrder","e","preventDefault","getMaxLeverage","orderRequest","is_buy","sz","parseFloat","limit_px","order_type","reduce_only","post","toUpperCase","_error$response","_error$response$data","detail","handleCancelOrder","oid","delete","find","c","symbol","maxLeverage","calculateNotionalValue","calculateMarginRequired","notional","formatPrice","toLocaleString","minimumFractionDigits","maximumFractionDigits","handleQuickFill","percentage","mockBalance","availableForPosition","className","children","change_24h","map","pair","onClick","onSubmit","onChange","target","min","max","step","parseInt","placeholder","id","checked","htmlFor","disabled","asks","slice","level","index","toString","bids","length","order"],"sources":["/app/frontend/src/components/Trading.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { TrendingUp, TrendingDown, DollarSign, Clock, AlertCircle, Target, Zap } from 'lucide-react';\nimport LoadingSpinner from './LoadingSpinner';\n\nconst Trading = () => {\n  const [orderForm, setOrderForm] = useState({\n    coin: 'BTC',\n    side: 'long', // Changed from 'buy' to 'long' for perps\n    orderType: 'limit',\n    size: '',\n    price: '',\n    leverage: 1,\n    reduceOnly: false,\n    postOnly: false\n  });\n  const [marketData, setMarketData] = useState({});\n  const [orderBook, setOrderBook] = useState(null);\n  const [openOrders, setOpenOrders] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [submitLoading, setSubmitLoading] = useState(false);\n  const [message, setMessage] = useState(null);\n  const [availableCoins, setAvailableCoins] = useState([]);\n\n  // Top 20 most popular perp pairs for quick access\n  const popularPairs = ['BTC', 'ETH', 'SOL', 'AVAX', 'MATIC', 'DOGE', 'LINK', 'UNI', 'AAVE', 'ARB', 'OP', 'LTC', 'XRP', 'BCH', 'APT', 'SUI', 'SEI', 'INJ', 'TIA', 'NEAR'];\n\n  useEffect(() => {\n    fetchAvailableCoins();\n    fetchTradingData();\n    const interval = setInterval(fetchTradingData, 10000); // Update every 10 seconds\n    return () => clearInterval(interval);\n  }, [orderForm.coin]);\n\n  const fetchAvailableCoins = async () => {\n    try {\n      const response = await axios.get('/api/coins');\n      if (response.data.success) {\n        setAvailableCoins(response.data.data);\n      }\n    } catch (error) {\n      console.error('Error fetching available coins:', error);\n    }\n  };\n\n  const fetchTradingData = async () => {\n    try {\n      setLoading(true);\n      \n      // Fetch market data\n      const marketResponse = await axios.get(`/api/market/${orderForm.coin}`);\n      if (marketResponse.data.success) {\n        setMarketData(marketResponse.data.data);\n        \n        // Auto-fill price for market orders\n        if (orderForm.orderType === 'market') {\n          const price = orderForm.side === 'long' ? marketResponse.data.data.ask : marketResponse.data.data.bid;\n          setOrderForm(prev => ({\n            ...prev,\n            price: price?.toFixed(2) || ''\n          }));\n        }\n      }\n\n      // Fetch order book\n      const orderBookResponse = await axios.get(`/api/orderbook/${orderForm.coin}`);\n      if (orderBookResponse.data.success) {\n        setOrderBook(orderBookResponse.data.data);\n      }\n\n      // Fetch open orders\n      const ordersResponse = await axios.get('/api/orders/open');\n      if (ordersResponse.data.success) {\n        setOpenOrders(ordersResponse.data.data);\n      }\n\n    } catch (error) {\n      console.error('Error fetching trading data:', error);\n      setMessage({ type: 'error', text: 'Failed to fetch trading data' });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleInputChange = (field, value) => {\n    setOrderForm(prev => ({\n      ...prev,\n      [field]: value\n    }));\n\n    // Auto-fill price for market orders\n    if (field === 'orderType' && value === 'market') {\n      const price = orderForm.side === 'long' ? marketData.ask : marketData.bid;\n      setOrderForm(prev => ({\n        ...prev,\n        price: price?.toFixed(2) || ''\n      }));\n    }\n\n    // Auto-fill price when switching sides\n    if (field === 'side') {\n      const price = value === 'long' ? marketData.ask : marketData.bid;\n      if (orderForm.orderType === 'market') {\n        setOrderForm(prev => ({\n          ...prev,\n          price: price?.toFixed(2) || ''\n        }));\n      }\n    }\n  };\n\n  const handleSubmitOrder = async (e) => {\n    e.preventDefault();\n    \n    if (!orderForm.size || (!orderForm.price && orderForm.orderType === 'limit')) {\n      setMessage({ type: 'error', text: 'Please fill in all required fields' });\n      return;\n    }\n\n    if (orderForm.leverage < 1 || orderForm.leverage > getMaxLeverage()) {\n      setMessage({ type: 'error', text: `Leverage must be between 1x and ${getMaxLeverage()}x` });\n      return;\n    }\n\n    try {\n      setSubmitLoading(true);\n      setMessage(null);\n\n      const orderRequest = {\n        coin: orderForm.coin,\n        is_buy: orderForm.side === 'long',\n        sz: parseFloat(orderForm.size),\n        limit_px: orderForm.orderType === 'limit' ? parseFloat(orderForm.price) : null,\n        order_type: orderForm.orderType,\n        reduce_only: orderForm.reduceOnly,\n        leverage: orderForm.leverage\n      };\n\n      const response = await axios.post('/api/orders', orderRequest);\n      \n      if (response.data.success) {\n        setMessage({ \n          type: 'success', \n          text: `${orderForm.side.toUpperCase()} order placed successfully! Size: ${orderForm.size} ${orderForm.coin} @ ${orderForm.leverage}x leverage` \n        });\n        setOrderForm(prev => ({ ...prev, size: '', price: '' }));\n        fetchTradingData(); // Refresh data\n      } else {\n        setMessage({ type: 'error', text: response.data.message || 'Failed to place order' });\n      }\n\n    } catch (error) {\n      console.error('Error placing order:', error);\n      setMessage({ \n        type: 'error', \n        text: error.response?.data?.detail || 'Failed to place order' \n      });\n    } finally {\n      setSubmitLoading(false);\n    }\n  };\n\n  const handleCancelOrder = async (coin, oid) => {\n    try {\n      const response = await axios.delete(`/api/orders/${coin}/${oid}`);\n      if (response.data.success) {\n        setMessage({ type: 'success', text: 'Order cancelled successfully!' });\n        fetchTradingData(); // Refresh data\n      } else {\n        setMessage({ type: 'error', text: 'Failed to cancel order' });\n      }\n    } catch (error) {\n      console.error('Error cancelling order:', error);\n      setMessage({ type: 'error', text: 'Failed to cancel order' });\n    }\n  };\n\n  const getMaxLeverage = () => {\n    const coin = availableCoins.find(c => c.symbol === orderForm.coin);\n    return coin?.maxLeverage || 1;\n  };\n\n  const calculateNotionalValue = () => {\n    const size = parseFloat(orderForm.size) || 0;\n    const price = parseFloat(orderForm.price) || marketData.price || 0;\n    return size * price;\n  };\n\n  const calculateMarginRequired = () => {\n    const notional = calculateNotionalValue();\n    return notional / orderForm.leverage;\n  };\n\n  const formatPrice = (price) => {\n    return `$${price?.toLocaleString('en-US', { \n      minimumFractionDigits: 2, \n      maximumFractionDigits: 2 \n    }) || '0.00'}`;\n  };\n\n  const handleQuickFill = (percentage) => {\n    // In a real implementation, this would use actual account balance\n    const mockBalance = 10000; // $10,000 mock balance\n    const price = parseFloat(orderForm.price) || marketData.price || 0;\n    const availableForPosition = (mockBalance * percentage / 100) * orderForm.leverage;\n    const size = availableForPosition / price;\n    \n    setOrderForm(prev => ({\n      ...prev,\n      size: size.toFixed(6)\n    }));\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <h1 className=\"text-3xl font-bold text-white\">Perpetual Futures Trading</h1>\n        <div className=\"flex items-center space-x-4\">\n          <div className=\"text-right\">\n            <p className=\"text-sm text-gray-400\">Mark Price</p>\n            <p className=\"text-lg font-bold text-white\">\n              {formatPrice(marketData.price)}\n            </p>\n          </div>\n          <div className={`px-3 py-1 rounded ${\n            marketData.change_24h >= 0 ? 'bg-green-900 text-green-300' : 'bg-red-900 text-red-300'\n          }`}>\n            {marketData.change_24h >= 0 ? '+' : ''}{marketData.change_24h?.toFixed(2)}%\n          </div>\n        </div>\n      </div>\n\n      {/* Popular Pairs Quick Access */}\n      <div className=\"bg-gray-800 p-4 rounded-lg border border-gray-700\">\n        <h3 className=\"text-sm font-medium text-gray-400 mb-2\">Popular Pairs</h3>\n        <div className=\"flex flex-wrap gap-2\">\n          {popularPairs.map(pair => (\n            <button\n              key={pair}\n              onClick={() => handleInputChange('coin', pair)}\n              className={`px-3 py-1 rounded text-sm font-medium transition-colors ${\n                orderForm.coin === pair\n                  ? 'bg-blue-600 text-white'\n                  : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\n              }`}\n            >\n              {pair}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* Message Display */}\n      {message && (\n        <div className={`p-4 rounded-lg flex items-center space-x-2 ${\n          message.type === 'success' \n            ? 'bg-green-900 text-green-300 border border-green-700' \n            : 'bg-red-900 text-red-300 border border-red-700'\n        }`}>\n          <AlertCircle size={20} />\n          <span>{message.text}</span>\n        </div>\n      )}\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Long/Short Order Form */}\n        <div className=\"lg:col-span-1\">\n          <div className=\"bg-gray-800 p-6 rounded-lg border border-gray-700\">\n            <h2 className=\"text-xl font-bold text-white mb-4 flex items-center\">\n              <Target className=\"w-5 h-5 mr-2\" />\n              Place Order\n            </h2>\n            \n            <form onSubmit={handleSubmitOrder} className=\"space-y-4\">\n              {/* Asset Selection */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-400 mb-2\">\n                  Perpetual Contract\n                </label>\n                <select\n                  value={orderForm.coin}\n                  onChange={(e) => handleInputChange('coin', e.target.value)}\n                  className=\"w-full bg-gray-700 text-white px-3 py-2 rounded border border-gray-600 focus:outline-none focus:border-blue-400\"\n                >\n                  {availableCoins.map(coin => (\n                    <option key={coin.symbol} value={coin.symbol}>\n                      {coin.symbol}-PERP (Max: {coin.maxLeverage}x)\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              {/* Long/Short Selection */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-400 mb-2\">\n                  Position Direction\n                </label>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <button\n                    type=\"button\"\n                    onClick={() => handleInputChange('side', 'long')}\n                    className={`py-3 px-4 rounded font-medium transition-colors flex items-center justify-center ${\n                      orderForm.side === 'long'\n                        ? 'bg-green-600 text-white'\n                        : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\n                    }`}\n                  >\n                    <TrendingUp size={16} className=\"mr-2\" />\n                    LONG\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => handleInputChange('side', 'short')}\n                    className={`py-3 px-4 rounded font-medium transition-colors flex items-center justify-center ${\n                      orderForm.side === 'short'\n                        ? 'bg-red-600 text-white'\n                        : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\n                    }`}\n                  >\n                    <TrendingDown size={16} className=\"mr-2\" />\n                    SHORT\n                  </button>\n                </div>\n              </div>\n\n              {/* Leverage */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-400 mb-2\">\n                  Leverage: {orderForm.leverage}x (Max: {getMaxLeverage()}x)\n                </label>\n                <input\n                  type=\"range\"\n                  min=\"1\"\n                  max={getMaxLeverage()}\n                  step=\"1\"\n                  value={orderForm.leverage}\n                  onChange={(e) => handleInputChange('leverage', parseInt(e.target.value))}\n                  className=\"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer\"\n                />\n                <div className=\"flex justify-between text-xs text-gray-500 mt-1\">\n                  <span>1x</span>\n                  <span>{getMaxLeverage()}x</span>\n                </div>\n              </div>\n\n              {/* Order Type */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-400 mb-2\">\n                  Order Type\n                </label>\n                <select\n                  value={orderForm.orderType}\n                  onChange={(e) => handleInputChange('orderType', e.target.value)}\n                  className=\"w-full bg-gray-700 text-white px-3 py-2 rounded border border-gray-600 focus:outline-none focus:border-blue-400\"\n                >\n                  <option value=\"limit\">Limit Order</option>\n                  <option value=\"market\">Market Order</option>\n                </select>\n              </div>\n\n              {/* Size */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-400 mb-2\">\n                  Size ({orderForm.coin})\n                </label>\n                <input\n                  type=\"number\"\n                  step=\"0.000001\"\n                  value={orderForm.size}\n                  onChange={(e) => handleInputChange('size', e.target.value)}\n                  placeholder=\"0.000000\"\n                  className=\"w-full bg-gray-700 text-white px-3 py-2 rounded border border-gray-600 focus:outline-none focus:border-blue-400\"\n                />\n                \n                {/* Quick Fill Buttons */}\n                <div className=\"flex space-x-1 mt-2\">\n                  {[25, 50, 75, 100].map(percentage => (\n                    <button\n                      key={percentage}\n                      type=\"button\"\n                      onClick={() => handleQuickFill(percentage)}\n                      className=\"flex-1 py-1 px-2 text-xs bg-gray-600 hover:bg-gray-500 rounded transition-colors\"\n                    >\n                      {percentage}%\n                    </button>\n                  ))}\n                </div>\n              </div>\n\n              {/* Price (for limit orders) */}\n              {orderForm.orderType === 'limit' && (\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-400 mb-2\">\n                    Price (USD)\n                  </label>\n                  <input\n                    type=\"number\"\n                    step=\"0.01\"\n                    value={orderForm.price}\n                    onChange={(e) => handleInputChange('price', e.target.value)}\n                    placeholder=\"0.00\"\n                    className=\"w-full bg-gray-700 text-white px-3 py-2 rounded border border-gray-600 focus:outline-none focus:border-blue-400\"\n                  />\n                </div>\n              )}\n\n              {/* Order Options */}\n              <div className=\"space-y-2\">\n                <div className=\"flex items-center space-x-2\">\n                  <input\n                    type=\"checkbox\"\n                    id=\"reduceOnly\"\n                    checked={orderForm.reduceOnly}\n                    onChange={(e) => handleInputChange('reduceOnly', e.target.checked)}\n                    className=\"w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500\"\n                  />\n                  <label htmlFor=\"reduceOnly\" className=\"text-sm text-gray-400\">\n                    Reduce Only\n                  </label>\n                </div>\n                \n                {orderForm.orderType === 'limit' && (\n                  <div className=\"flex items-center space-x-2\">\n                    <input\n                      type=\"checkbox\"\n                      id=\"postOnly\"\n                      checked={orderForm.postOnly}\n                      onChange={(e) => handleInputChange('postOnly', e.target.checked)}\n                      className=\"w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500\"\n                    />\n                    <label htmlFor=\"postOnly\" className=\"text-sm text-gray-400\">\n                      Post Only\n                    </label>\n                  </div>\n                )}\n              </div>\n\n              {/* Order Summary */}\n              {orderForm.size && orderForm.price && (\n                <div className=\"p-3 bg-gray-700 rounded space-y-1 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-gray-400\">Notional Value:</span>\n                    <span className=\"text-white\">{formatPrice(calculateNotionalValue())}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-gray-400\">Margin Required:</span>\n                    <span className=\"text-white\">{formatPrice(calculateMarginRequired())}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-gray-400\">Leverage:</span>\n                    <span className=\"text-white\">{orderForm.leverage}x</span>\n                  </div>\n                </div>\n              )}\n\n              {/* Submit Button */}\n              <button\n                type=\"submit\"\n                disabled={submitLoading}\n                className={`w-full py-3 px-4 rounded font-medium transition-colors flex items-center justify-center ${\n                  orderForm.side === 'long'\n                    ? 'bg-green-600 hover:bg-green-700 text-white'\n                    : 'bg-red-600 hover:bg-red-700 text-white'\n                } disabled:opacity-50 disabled:cursor-not-allowed`}\n              >\n                {submitLoading ? (\n                  <LoadingSpinner size=\"small\" />\n                ) : (\n                  <>\n                    <Zap size={16} className=\"mr-2\" />\n                    {orderForm.side.toUpperCase()} {orderForm.coin}-PERP\n                  </>\n                )}\n              </button>\n            </form>\n          </div>\n        </div>\n\n        {/* Order Book */}\n        <div className=\"lg:col-span-1\">\n          <div className=\"bg-gray-800 p-6 rounded-lg border border-gray-700\">\n            <h2 className=\"text-xl font-bold text-white mb-4\">Order Book</h2>\n            \n            {loading ? (\n              <div className=\"flex justify-center py-8\">\n                <LoadingSpinner />\n              </div>\n            ) : orderBook ? (\n              <div className=\"space-y-4\">\n                {/* Asks */}\n                <div>\n                  <h3 className=\"text-sm font-medium text-red-400 mb-2\">Asks (Resistance)</h3>\n                  <div className=\"space-y-1\">\n                    {orderBook.asks?.slice(0, 10).map((level, index) => (\n                      <div key={index} className=\"flex justify-between text-sm hover:bg-red-900/20 p-1 rounded cursor-pointer\"\n                           onClick={() => orderForm.orderType === 'limit' && handleInputChange('price', level.price.toString())}>\n                        <span className=\"text-red-400 font-mono\">{formatPrice(level.price)}</span>\n                        <span className=\"text-gray-400\">{level.size}</span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Current Price */}\n                <div className=\"text-center py-2 border-t border-b border-gray-700\">\n                  <span className=\"text-lg font-bold text-white\">\n                    {formatPrice(marketData.price)}\n                  </span>\n                  <p className=\"text-xs text-gray-400\">Mark Price</p>\n                </div>\n\n                {/* Bids */}\n                <div>\n                  <h3 className=\"text-sm font-medium text-green-400 mb-2\">Bids (Support)</h3>\n                  <div className=\"space-y-1\">\n                    {orderBook.bids?.slice(0, 10).map((level, index) => (\n                      <div key={index} className=\"flex justify-between text-sm hover:bg-green-900/20 p-1 rounded cursor-pointer\"\n                           onClick={() => orderForm.orderType === 'limit' && handleInputChange('price', level.price.toString())}>\n                        <span className=\"text-green-400 font-mono\">{formatPrice(level.price)}</span>\n                        <span className=\"text-gray-400\">{level.size}</span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              </div>\n            ) : (\n              <p className=\"text-gray-400 text-center py-8\">No order book data available</p>\n            )}\n          </div>\n        </div>\n\n        {/* Open Orders */}\n        <div className=\"lg:col-span-1\">\n          <div className=\"bg-gray-800 p-6 rounded-lg border border-gray-700\">\n            <h2 className=\"text-xl font-bold text-white mb-4\">Open Orders</h2>\n            \n            {loading ? (\n              <div className=\"flex justify-center py-8\">\n                <LoadingSpinner />\n              </div>\n            ) : openOrders.length > 0 ? (\n              <div className=\"space-y-3\">\n                {openOrders.map((order, index) => (\n                  <div key={index} className=\"p-3 bg-gray-700 rounded border border-gray-600\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div className=\"flex items-center space-x-2\">\n                        <span className=\"font-semibold text-white\">{order.coin}-PERP</span>\n                        <span className={`px-2 py-1 rounded text-xs font-medium ${\n                          order.side === 'buy' \n                            ? 'bg-green-900 text-green-300'\n                            : 'bg-red-900 text-red-300'\n                        }`}>\n                          {order.side === 'buy' ? 'LONG' : 'SHORT'}\n                        </span>\n                      </div>\n                      <button\n                        onClick={() => handleCancelOrder(order.coin, order.oid)}\n                        className=\"text-red-400 hover:text-red-300 text-sm\"\n                      >\n                        Cancel\n                      </button>\n                    </div>\n                    <div className=\"text-sm text-gray-400\">\n                      <p>Size: {order.size}</p>\n                      {order.price && <p>Price: {formatPrice(order.price)}</p>}\n                      <p>Type: {order.order_type}</p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <p className=\"text-gray-400 text-center py-8\">No open orders</p>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Trading;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}